#!/bin/bash
zcat ${1} | ./VCF2vepVCF.py | perl /fast/users/pkleiner_c/vep77/ensembl-tools-release-77/scripts/variant_effect_predictor/variant_effect_predictor.pl --no_stats --fasta /fast/users/pkleiner_c/sequencedb/Homo_sapiens.GRCh37.72.dna.toplevel.fa --quiet --buffer 2000 --cache --offline --species homo_sapiens --db_version=77 --format vcf --symbol --hgvs --regulatory --gmaf --sift b --polyphen b --ccds --domains --numbers --canonical --shift_hgvs --output_file >( awk 'BEGIN{ FS="\t"; OFS="\t"; }{ if ($1 ~ /^##/) { print } else if ($1 ~ /^#/) { sub("^#","",$0); print "#Chrom","Start","End",$0 } else { split($2,a,":"); if (a[2] ~ /-/) { split(a[2],b,"-"); print a[1],b[1],b[2],$0 } else { print a[1],a[2],a[2],$0 } } }' | grep -E "(^#|ENST00000360256|ENST00000218099)" | bgzip -c > ${2} ) --force_overwrite
